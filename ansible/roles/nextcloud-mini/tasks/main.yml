---
# ============================================================================
# TASKS PRINCIPALES - NEXTCLOUD-MINI
# Orchestration du dÃ©ploiement
# ============================================================================

- name: "ğŸ“‹ Affichage configuration dÃ©ploiement"
  debug:
    msg:
      - "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
      - "  Configuration Nextcloud Mini"
      - "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
      - "Version        : {{ nextcloud_version }}"
      - "Serveur        : {{ inventory_hostname }}"
      - "Port HTTP      : {{ nextcloud_http_port }}"
      - "RÃ©pertoire app : {{ nextcloud_install_dir }}"
      - "RÃ©pertoire data: {{ nextcloud_data_dir }}"
      - "Mode offline   : {{ offline_mode }}"
      - "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

- name: "â¸ï¸  Pause lecture configuration (2 secondes)"
  pause:
    seconds: 2

# ============================================================================
# EXÃ‰CUTION SÃ‰QUENTIELLE DES Ã‰TAPES
# ============================================================================

- name: "1ï¸âƒ£  VÃ©rification prÃ©requis systÃ¨me"
  include_tasks: 01-prerequisites.yml
  tags: [prerequisites]

- name: "2ï¸âƒ£  Installation paquets systÃ¨me"
  include_tasks: 02-install-packages.yml
  tags: [packages]

- name: "3ï¸âƒ£  Configuration base de donnÃ©es MariaDB"
  include_tasks: 03-database.yml
  tags: [database]

- name: "4ï¸âƒ£  Configuration PHP"
  include_tasks: 04-php-config.yml
  tags: [php]

- name: "5ï¸âƒ£  Installation et configuration Nextcloud"
  include_tasks: 05-nextcloud-install.yml
  tags: [nextcloud]

- name: "6ï¸âƒ£  Configuration Apache VirtualHost"
  include_tasks: 06-apache-config.yml
  tags: [apache]

- name: "7ï¸âƒ£  Validation dÃ©ploiement"
  include_tasks: 07-validation.yml
  tags: [validation]

# ============================================================================
# RÃ‰SUMÃ‰ FINAL
# ============================================================================

- name: "âœ… DÃ©ploiement terminÃ©"
  debug:
    msg:
      - ""
      - "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
      - "â•‘                                                               â•‘"
      - "â•‘         âœ… NEXTCLOUD OPÃ‰RATIONNEL                             â•‘"
      - "â•‘                                                               â•‘"
      - "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
      - ""
      - "ğŸ”— URL : http://{{ ansible_default_ipv4.address }}:{{ nextcloud_http_port }}"
      - "ğŸ‘¤ User: {{ nextcloud_admin_user }}"
      - "ğŸ”‘ Pass: {{ nextcloud_admin_password }}"
      - ""
