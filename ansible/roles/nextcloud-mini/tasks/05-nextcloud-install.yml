---
# ====================================================================
# Ã‰TAPE 5 : INSTALLATION NEXTCLOUD (OFFLINE CORRECT)
# ====================================================================

- name: "ğŸ“ CrÃ©ation rÃ©pertoire web racine"
  file:
    path: "/var/www"
    state: directory
    mode: '0755'

- name: "ğŸ“ CrÃ©ation rÃ©pertoire Nextcloud"
  file:
    path: "{{ nextcloud_install_dir }}"
    state: directory
    owner: "{{ nextcloud_web_user }}"
    group: "{{ nextcloud_web_group }}"
    mode: '0755'

# ğŸ”‘ Ã‰TAPE MANQUANTE JUSQUâ€™ICI
- name: "ğŸ“¥ Copie archive Nextcloud vers zt-app"
  copy:
    src: "{{ nextcloud_local_cache }}"
    dest: "{{ nextcloud_remote_tmp }}"
    mode: '0644'

- name: "ğŸ“‚ Extraction archive Nextcloud"
  unarchive:
    src: "{{ nextcloud_remote_tmp }}"
    dest: "/var/www"
    remote_src: yes
    owner: "{{ nextcloud_web_user }}"
    group: "{{ nextcloud_web_group }}"
    creates: "{{ nextcloud_install_dir }}/occ"

- name: "ğŸ” Correction permissions rÃ©cursives"
  file:
    path: "{{ nextcloud_install_dir }}"
    owner: "{{ nextcloud_web_user }}"
    group: "{{ nextcloud_web_group }}"
    recurse: yes
